fit <- hclust(d, method="ward.D")
groups <- cutree(fit, k=5)
# Ward hierarchical
hc.res <- eclust(pcs, "hclust", k = 5, hc_metric = "euclidean",
hc_method = "ward.D", graph = FALSE)
fviz_dend(hc.res, show_labels = FALSE, palette = "jco", as.ggplot = TRUE)
df_ward <- rbind(data, NewCluster = groups)
# Ward
d <- dist(pcs, method = "euclidean")
fit <- hclust(d, method="ward.D")
groups <- cutree(fit, k=5)
# Ward hierarchical
hc.res <- eclust(pcs, "hclust", k = 5, hc_metric = "euclidean",
hc_method = "ward.D", graph = FALSE)
fviz_dend(hc.res, show_labels = FALSE, palette = "jco", as.ggplot = TRUE)
df_ward <- rbind(data, NewCluster = groups)
write.csv(df_ward, row.names = F, 'WardClustering_GoMF.csv')
write.csv(df_ward, row.names = F, 'WardClustering.csv')
fviz_dend(as.dendrogram(hc.res),
k = 5,
k_colors = c("#00A9FF", "#E7B800", "#00AFBB", "#FC4E07", "#2E9FDF"),
color_labels_by_k = TRUE,
show_labels = FALSE
)
fviz_dend(as.dendrogram(hc.res),
k = 5,
k_colors = c("#00AFBB", "#E7B800", "#00AFBB", "#FC4E07", "#2E9FDF"),
color_labels_by_k = TRUE,
show_labels = FALSE
)
fviz_dend(as.dendrogram(hc.res),
k = 5,
k_colors = c("#00A9FF", "#E7B800", "#00AFBB", "#FC4E07", "#C77CFF"),
color_labels_by_k = TRUE,
show_labels = FALSE
)
data = read.csv("UltimateData.csv")
c1 = data[data$ClusterNo == 1, ]
c2 = data[data$ClusterNo == 2, ]
c3 = data[data$ClusterNo == 3, ]
c4 = data[data$ClusterNo == 4, ]
c5 = data[data$ClusterNo == 5, ]
ss_c1 = floor(0.5*nrow(c1))
ss_c2 = floor(0.5*nrow(c2))
ss_c3 = floor(0.5*nrow(c3))
ss_c4 = floor(0.5*nrow(c4))
ss_c5 = floor(0.5*nrow(c5))
picked_c1 = sample(seq_len(nrow(c1)),size = ss_c1)
picked_c2 = sample(seq_len(nrow(c2)),size = ss_c2)
picked_c3 = sample(seq_len(nrow(c3)),size = ss_c3)
picked_c4 = sample(seq_len(nrow(c4)),size = ss_c4)
picked_c5 = sample(seq_len(nrow(c5)),size = ss_c5)
development_c1 = c1[picked_c1,]
holdout_c1 = c1[-picked_c1,]
development_c2 = c2[picked_c2,]
holdout_c2 = c2[-picked_c2,]
development_c3 = c3[picked_c3,]
holdout_c3 = c3[-picked_c3,]
development_c4 = c4[picked_c4,]
holdout_c4 = c4[-picked_c4,]
development_c5 = c5[picked_c5,]
holdout_c5 = c5[-picked_c5,]
View(holdout_c5)
dev <- rbind(development_c1, development_c2, development_c3, development_c4, development_c5)
holdout <- rbind(holdout_c1, holdout_c2, holdout_c3, holdout_c4, holdout_c5)
df <- select(dev,
MFRBlockHz,
tf_MedIsi,
tf_Entropy,
tf_CV2Mean,
tf_LvR)
# PCA (we need to ignore missing values from responsive units)
df.pca <- prcomp(na.omit(df), center = TRUE, scale = TRUE)
summary(df.pca)
pcs <- data.frame(df.pca$x[,1:5])
# We clearly have 2 clusters here. Hopefully Golgi and MF separated
fviz_nbclust(pcs, hcut, method = c("silhouette", "wss", "gap_stat"))
d <- dist(pcs, method = "euclidean")
fit <- hclust(d, method="ward.D")
groups <- cutree(fit, k=5)
# Ward hierarchical
hc.res <- eclust(pcs, "hclust", k = 5, hc_metric = "euclidean",
hc_method = "ward.D", graph = FALSE)
fviz_dend(as.dendrogram(hc.res),
k = 5,
k_colors = c("#00A9FF", "#E7B800", "#00AFBB", "#FC4E07", "#C77CFF"),
color_labels_by_k = TRUE,
show_labels = FALSE
)
write.csv(dev, row.names = F, 'ClusteringData.csv')
write.csv(holdout, row.names = F, 'ClassificationData.csv')
df_ward <- rbind(dev, NewCluster = groups)
write.csv(df_ward, row.names = F, 'WardClustering.csv')
df_ward <- cbind(dev, NewCluster = groups)
write.csv(df_ward, row.names = F, 'WardClustering.csv')
fviz_dend(as.dendrogram(hc.res),
k = 6,
k_colors = c("#00A9FF", "#E7B800", "#00AFBB", "#FC4E07", "#C77CFF"),
color_labels_by_k = TRUE,
show_labels = FALSE
)
# Ward hierarchical
hc.res <- eclust(pcs, "hclust", k = 2, hc_metric = "euclidean",
hc_method = "ward.D", graph = FALSE)
fviz_dend(as.dendrogram(hc.res),
k = 2,
k_colors = c("#00A9FF", "#E7B800", "#00AFBB", "#FC4E07", "#C77CFF"),
color_labels_by_k = TRUE,
show_labels = FALSE
)
groups <- cutree(fit, k=3)
d <- dist(pcs, method = "euclidean")
fit <- hclust(d, method="ward.D")
groups <- cutree(fit, k=3)
# Ward hierarchical
hc.res <- eclust(pcs, "hclust", k = 3, hc_metric = "euclidean",
hc_method = "ward.D", graph = FALSE)
fviz_dend(as.dendrogram(hc.res),
k = 3,
k_colors = c("#00A9FF", "#E7B800", "#00AFBB", "#FC4E07", "#C77CFF"),
color_labels_by_k = TRUE,
show_labels = FALSE
)
# Now let's split third cluster
df_ward <- cbind(dev, NewCluster = groups)
nrow(df_ward$NewCluster)
df_ward$NewCluster
nrow(df_ward$NewCluster)
sort(table(df_ward$NewCluster))
names(sort(table(df_ward$NewCluster)))
grMl <- df_ward[df_ward$NewCluster == 2, ]
df2 <- select(grMl,
MFRBlockHz,
tf_MedIsi,
tf_Entropy,
tf_CV2Mean,
tf_LvR)
# PCA (we need to ignore missing values from responsive units)
df.pca <- prcomp(na.omit(df2), center = TRUE, scale = TRUE)
summary(df.pca)
pcs <- data.frame(df2.pca$x[,1:5])
# PCA (we need to ignore missing values from responsive units)
df2.pca <- prcomp(na.omit(df2), center = TRUE, scale = TRUE)
summary(df2.pca)
pcs <- data.frame(df2.pca$x[,1:5])
# We clearly have 2 clusters here. Hopefully Golgi and MF separated
fviz_nbclust(pcs, hcut, method = c("silhouette", "wss", "gap_stat"))
d <- dist(pcs, method = "euclidean")
fit <- hclust(d, method="ward.D")
groups <- cutree(fit, k=4)
# Ward hierarchical
hc.res <- eclust(pcs, "hclust", k = 4, hc_metric = "euclidean",
hc_method = "ward.D", graph = FALSE)
fviz_dend(as.dendrogram(hc.res),
k = 4,
k_colors = c("#00A9FF", "#E7B800", "#00AFBB", "#FC4E07", "#C77CFF"),
color_labels_by_k = TRUE,
show_labels = FALSE
)
df_ward2 <- cbind(grMl, NewCluster2 = groups)
PkCS <- df_ward[df_ward$NewCluster %in% c(1,3), ]
df_ward2 <- grMl[-c('Cluster')]
df_ward2 <- grMl[!Cluster, ]
df_ward2 <- grMl[!NewCluster, ]
View(grMl)
View(df_ward2)
grMl <- df_ward[df_ward$NewCluster == 2, ]
df_ward2 <- grMl[!NewCluster, ]
View(grMl)
dev <- read.csv("ClusteringData.csv")
df <- select(dev,
MFRBlockHz,
tf_MedIsi,
tf_Entropy,
tf_CV2Mean,
tf_LvR)
# PCA (we need to ignore missing values from responsive units)
df.pca <- prcomp(na.omit(df), center = TRUE, scale = TRUE)
summary(df.pca)
pcs <- data.frame(df.pca$x[,1:5])
d <- dist(pcs, method = "euclidean")
fit <- hclust(d, method="ward.D")
groups <- cutree(fit, k=3)
# Ward hierarchical
hc.res <- eclust(pcs, "hclust", k = 3, hc_metric = "euclidean",
hc_method = "ward.D", graph = FALSE)
fviz_dend(as.dendrogram(hc.res),
k = 3,
k_colors = c("#00A9FF", "#E7B800", "#00AFBB", "#FC4E07", "#C77CFF"),
color_labels_by_k = TRUE,
show_labels = FALSE
)
# Now let's split third cluster
df_ward <- cbind(dev, NewCluster = groups)
# Now let's split third cluster
df_ward <- cbind(dev, NewCluster = groups)
sort(table(df_ward$NewCluster))
names(sort(table(df_ward$NewCluster)))
grMl <- df_ward[df_ward$NewCluster == 2, ]
grMl <- grMl[!NewCluster, ]
View(grMl)
df_ward$NewCluster
grMl <- grMl[!grMl$NewCluster, ]
grMl <- df_ward[df_ward$NewCluster == 2, ]
grMl <- subset(grMl, select=-c('NewCluster'))
grMl <- subset(grMl, select=-c(NewCluster))
df2 <- select(grMl,
MFRBlockHz,
tf_MedIsi,
tf_Entropy,
tf_CV2Mean,
tf_LvR)
# PCA (we need to ignore missing values from responsive units)
df2.pca <- prcomp(na.omit(df2), center = TRUE, scale = TRUE)
summary(df2.pca)
pcs <- data.frame(df2.pca$x[,1:5])
d <- dist(pcs, method = "euclidean")
fit <- hclust(d, method="ward.D")
groups <- cutree(fit, k=4)
# Ward hierarchical
hc.res <- eclust(pcs, "hclust", k = 4, hc_metric = "euclidean",
hc_method = "ward.D", graph = FALSE)
fviz_dend(as.dendrogram(hc.res),
k = 4,
k_colors = c("#00A9FF", "#E7B800", "#00AFBB", "#FC4E07", "#C77CFF"),
color_labels_by_k = TRUE,
show_labels = FALSE
)
df_ward2 <- cbind(grMl, NewCluster = groups)
PkCS <- df_ward[df_ward$NewCluster %in% c(1,3), ]
sort(table(df_ward2$NewCluster))
df_ward2$NewCluster[df_ward2$NewCluster == 1] <- 2
df_ward2$NewCluster[df_ward2$NewCluster == 2] <- 4
df_ward2$NewCluster[df_ward2$NewCluster == 3] <- 5
df_ward2$NewCluster[df_ward2$NewCluster == 4] <- 6
names(sort(table(df_ward2$NewCluster)))
df_ward2 <- cbind(grMl, NewCluster = groups)
names(sort(table(df_ward2$NewCluster)))
# sort(table(df_ward2$NewCluster))
df_ward2$NewCluster[df_ward2$NewCluster == 1] <- 8
df_ward2$NewCluster[df_ward2$NewCluster == 2] <- 9
df_ward2$NewCluster[df_ward2$NewCluster == 3] <- 5
df_ward2$NewCluster[df_ward2$NewCluster == 4] <- 6
df_ward2$NewCluster[df_ward2$NewCluster == 8] <- 2
df_ward2$NewCluster[df_ward2$NewCluster == 9] <- 4
names(sort(table(df_ward2$NewCluster)))
# Put all together
total <- rbind(PkCS, df_ward2)
write.csv(total, row.names = F, 'WardClusteringAll.csv')
library(dplyr)
library(ggbiplot)
library(rgl)
library(RColorBrewer)
library(scales)
library(pvclust)
library(factoextra)
library(fpc)
library(NbClust)
library(ggplot2)
data = read.csv("UltimateData.csv")
MLI <- c5 = data[data$Cluster == 'MLI', ]
MLI <- data[data$Cluster == 'MLI', ]
df <- select(dev,
MFRBlockHz,
tf_MedIsi,
tf_Entropy,
tf_CV2Mean,
tf_LvR)
df <- select(MLI,
MFRBlockHz,
tf_MedIsi,
tf_Entropy,
tf_CV2Mean,
tf_LvR)
# PCA (we need to ignore missing values from responsive units)
df.pca <- prcomp(na.omit(df), center = TRUE, scale = TRUE)
summary(df.pca)
ggbiplot(df.pca)
pcs <- data.frame(df.pca$x[,1:5])
# We clearly have 2 clusters here. Hopefully Golgi and MF separated
fviz_nbclust(pcs, hcut, method = c("silhouette", "wss", "gap_stat"))
fviz_nbclust(pcs, hcut, method = c("gap_stat"))
fviz_nbclust(pcs, hcut, method = c("wss"))
fviz_nbclust(pcs, hcut, method = c("silhouette"))
fviz_nbclust(pcs, hcut, method = c("gap_stat"))
d <- dist(pcs, method = "euclidean")
fit <- hclust(d, method="ward.D")
groups <- cutree(fit, k=6)
# Ward hierarchical
hc.res <- eclust(pcs, "hclust", k = 6, hc_metric = "euclidean",
hc_method = "ward.D", graph = FALSE)
fviz_dend(as.dendrogram(hc.res),
k = 6,
k_colors = c("#00A9FF", "#E7B800", "#00AFBB", "#FC4E07", "#C77CFF"),
color_labels_by_k = TRUE,
show_labels = FALSE
)
df_ward_MLI <- cbind(MLI, NewCluster = groups)
View(df_ward_MLI)
sort(table(df_ward_MLI$NewCluster))
write.csv(total, row.names = F, 'MLI_subdivision.csv')
write.csv(df_ward_MLI, row.names = F, 'MLI_subdivision.csv')
# Split further GoMF cluster
GoMF <- data[data$Cluster == 'GoMF', ]
df <- select(GoMF,
MFRBlockHz,
tf_MedIsi,
tf_Entropy,
tf_CV2Mean,
tf_LvR)
# PCA (we need to ignore missing values from responsive units)
df.pca <- prcomp(na.omit(df), center = TRUE, scale = TRUE)
summary(df.pca)
ggbiplot(df.pca)
pcs <- data.frame(df.pca$x[,1:5])
fviz_nbclust(pcs, hcut, method = c("gap_stat"))
fviz_nbclust(pcs, hcut, method = c("silhouette"))
fviz_nbclust(pcs, hcut, method = c("wss"))
fviz_nbclust(pcs, hcut, method = c("silhouette"))
d <- dist(pcs, method = "euclidean")
fit <- hclust(d, method="ward.D")
groups <- cutree(fit, k=2)
# Ward hierarchical
hc.res <- eclust(pcs, "hclust", k = 2, hc_metric = "euclidean",
hc_method = "ward.D", graph = FALSE)
fviz_dend(as.dendrogram(hc.res),
k = 2,
k_colors = c("#00A9FF", "#E7B800", "#00AFBB", "#FC4E07", "#C77CFF"),
color_labels_by_k = TRUE,
show_labels = FALSE
)
d <- dist(pcs, method = "euclidean")
fit <- hclust(d, method="ward.D")
groups <- cutree(fit, k=4)
# Ward hierarchical
hc.res <- eclust(pcs, "hclust", k = 4, hc_metric = "euclidean",
hc_method = "ward.D", graph = FALSE)
fviz_dend(as.dendrogram(hc.res),
k = 4,
k_colors = c("#00A9FF", "#E7B800", "#00AFBB", "#FC4E07", "#C77CFF"),
color_labels_by_k = TRUE,
show_labels = FALSE
)
df_ward_GoMF <- cbind(GoMF, NewCluster = groups)
sort(table(df_ward_GoMF$NewCluster))
write.csv(df_ward_GoMF, row.names = F, 'GoMF_subdivision.csv')
data$Cluster
# Split further PkC cluster
Pk <- data[data$Cluster == 'Pk', ]
df <- select(Pk,
MFRBlockHz,
tf_MedIsi,
tf_Entropy,
tf_CV2Mean,
tf_LvR)
# PCA (we need to ignore missing values from responsive units)
df.pca <- prcomp(na.omit(df), center = TRUE, scale = TRUE)
summary(df.pca)
fviz_nbclust(pcs, hcut, method = c("silhouette"))
d <- dist(pcs, method = "euclidean")
fit <- hclust(d, method="ward.D")
groups <- cutree(fit, k=4
# Ward hierarchical
hc.res <- eclust(pcs, "hclust", k = 4, hc_metric = "euclidean",
hc_method = "ward.D", graph = FALSE)
fviz_nbclust(pcs, hcut, method = c("gap_stat"))
fviz_dend(as.dendrogram(hc.res),
k = 4,
k_colors = c("#00A9FF", "#E7B800", "#00AFBB", "#FC4E07", "#C77CFF"),
color_labels_by_k = TRUE,
show_labels = FALSE
)
df_ward_Pk <- cbind(Pk, NewCluster = groups)
sort(table(df_ward_Pk$NewCluster))
df_ward_Pk <- cbind(Pk, NewCluster = groups)
pcs <- data.frame(df.pca$x[,1:5])
# Ward
d <- dist(pcs, method = "euclidean")
fit <- hclust(d, method="ward.D")
groups <- cutree(fit, k=4)
# Ward hierarchical
hc.res <- eclust(pcs, "hclust", k = 4, hc_metric = "euclidean",
hc_method = "ward.D", graph = FALSE)
fviz_dend(as.dendrogram(hc.res),
k = 4,
k_colors = c("#00A9FF", "#E7B800", "#00AFBB", "#FC4E07", "#C77CFF"),
color_labels_by_k = TRUE,
show_labels = FALSE
)
df_ward_Pk <- cbind(Pk, NewCluster = groups)
sort(table(df_ward_Pk$NewCluster))
write.csv(df_ward_GoMF, row.names = F, 'Pk_subdivision.csv')
write.csv(df_ward_Pk, row.names = F, 'Pk_subdivision.csv')
sort(table(df_ward_Pk$NewCluster))
write.csv(df_ward_Pk, row.names = F, 'Pk_subdivision.csv')
# Now we want to consider these subclusters
df_ward_Pk <- subset(df_ward_Pk, select=-c(Cluster))
df_ward_GoMF <- subset(df_ward_GoMF, select=-c(Cluster))
df_ward_MLI <- subset(df_ward_MLI, select=-c(Cluster))
# # Split further CS cluster
CS <- data[data$Cluster == 'CS', ]
df <- select(CS,
MFRBlockHz,
tf_MedIsi,
tf_Entropy,
tf_CV2Mean,
tf_LvR)
# PCA (we need to ignore missing values from responsive units)
df.pca <- prcomp(na.omit(df), center = TRUE, scale = TRUE)
summary(df.pca)
ggbiplot(df.pca)
pcs <- data.frame(df.pca$x[,1:5])
fviz_nbclust(pcs, hcut, method = c("gap_stat"))
# We clearly have 2 clusters here. Hopefully Golgi and MF separated
fviz_nbclust(pcs, hcut, method = c("silhouette", "wss", "gap_stat"))
# Ward
d <- dist(pcs, method = "euclidean")
fit <- hclust(d, method="ward.D")
groups <- cutree(fit, k=2)
# Ward hierarchical
hc.res <- eclust(pcs, "hclust", k = 2, hc_metric = "euclidean",
hc_method = "ward.D", graph = FALSE)
fviz_dend(as.dendrogram(hc.res),
k = 2,
k_colors = c("#00A9FF", "#E7B800", "#00AFBB", "#FC4E07", "#C77CFF"),
color_labels_by_k = TRUE,
show_labels = FALSE
)
df_ward_CS <- cbind(CS, NewCluster = groups)
sort(table(df_ward_CS$NewCluster))
write.csv(df_ward_CS, row.names = F, 'CS_subdivision.csv')
# Split further Granule cluster
Gr <- data[data$Cluster == 'Gr', ]
df <- select(Gr,
MFRBlockHz,
tf_MedIsi,
tf_Entropy,
tf_CV2Mean,
tf_LvR)
# PCA (we need to ignore missing values from responsive units)
df.pca <- prcomp(na.omit(df), center = TRUE, scale = TRUE)
summary(df.pca)
ggbiplot(df.pca)
pcs <- data.frame(df.pca$x[,1:5])
# We clearly have 2 clusters here. Hopefully Golgi and MF separated
fviz_nbclust(pcs, hcut, method = c("silhouette", "wss", "gap_stat"))
fviz_nbclust(pcs, hcut, method = c("gap_stat"))
fviz_nbclust(pcs, hcut, method = c("gap_stat"))
# We clearly have 2 clusters here. Hopefully Golgi and MF separated
fviz_nbclust(pcs, hcut, method = c("silhouette", "wss", "gap_stat"))
# Ward
d <- dist(pcs, method = "euclidean")
fit <- hclust(d, method="ward.D")
groups <- cutree(fit, k=2)
# Ward hierarchical
hc.res <- eclust(pcs, "hclust", k = 2, hc_metric = "euclidean",
hc_method = "ward.D", graph = FALSE)
fviz_dend(as.dendrogram(hc.res),
k = 2,
k_colors = c("#00A9FF", "#E7B800", "#00AFBB", "#FC4E07", "#C77CFF"),
color_labels_by_k = TRUE,
show_labels = FALSE
)
fviz_dend(as.dendrogram(hc.res),
k = 4,
k_colors = c("#00A9FF", "#E7B800", "#00AFBB", "#FC4E07", "#C77CFF"),
color_labels_by_k = TRUE,
show_labels = FALSE
)
fviz_dend(as.dendrogram(hc.res),
k = 3,
k_colors = c("#00A9FF", "#E7B800", "#00AFBB", "#FC4E07", "#C77CFF"),
color_labels_by_k = TRUE,
show_labels = FALSE
)
fviz_dend(as.dendrogram(hc.res),
k = 2,
k_colors = c("#00A9FF", "#E7B800", "#00AFBB", "#FC4E07", "#C77CFF"),
color_labels_by_k = TRUE,
show_labels = FALSE
)
df_ward_Gr <- cbind(Gr, NewCluster = groups)
sort(table(df_ward_Gr$NewCluster))
write.csv(df_ward_Gr, row.names = F, 'Gr_subdivision.csv')
df_ward_Gr <- subset(df_ward_Gr, select=-c(Cluster))
df_ward_CS <- subset(df_ward_CS, select=-c(Cluster))
View(df_ward_Pk)
df_ward_Pk$SubCluster <- ifelse(df_ward_Pk$NewCluster == 1, 'Pk',
ifelse(df_ward_Pk$NewCluster == 2, 'Pk',
ifelse(df_ward_Pk$NewCluster == 3, 'Pk',
ifelse(df_ward_Pk$NewCluster == 4, -1, -1))))
View(df_ward_Pk)
df_ward_Pk$SubCluster
sort(table(df_ward_Pk$SubCluster))
df_ward_CS$SubCluster <- ifelse(df_ward_CS$NewCluster == 1, 'CS',
ifelse(df_ward_CS$NewCluster == 2, 'CS', -1))
sort(table(df_ward_Pk$SubCluster))
sort(table(df_ward_CS$SubCluster))
df_ward_Gr$SubCluster <- ifelse(df_ward_Gr$NewCluster == 1, 'Gr',
ifelse(df_ward_Gr$NewCluster == 2, 'Gr', -1))
sort(table(df_ward_Gr$SubCluster))
df_ward_GoMF$SubCluster <- ifelse(df_ward_GoMF$NewCluster == 1, 'MF', -1)
sort(table(df_ward_GoMF$SubCluster))
df_ward_MLI$SubCluster <- ifelse(df_ward_MLI$NewCluster == 0, 'MLI', -1)
sort(table(df_ward_MLI$SubCluster))
# Let's merge all this together
subc <- rbind(df_ward_Pk, df_ward_CS, df_ward_Gr, df_ward_GoMF, df_ward_MLI)
View(subc)
sort(table(subc$SubCluster))
sort(table(subc$ClusterNo))
sort(table(subc$SubCluster))
write.csv(subc, row.names = F, 'AllData_Subclusters.csv')
